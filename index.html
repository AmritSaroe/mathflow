<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>MathFlow</title>
  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#0f0f0f">
  <link rel="apple-touch-icon" href="./icon.png">

  <!-- â”€â”€ CSS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <link rel="stylesheet" href="./css/variables.css">
  <link rel="stylesheet" href="./css/base.css">
  <link rel="stylesheet" href="./css/layout.css">
  <link rel="stylesheet" href="./css/components.css">
  <link rel="stylesheet" href="./css/screens/home.css">
  <link rel="stylesheet" href="./css/screens/subtopic.css">
  <link rel="stylesheet" href="./css/screens/mode.css">
  <link rel="stylesheet" href="./css/screens/practice.css">
  <link rel="stylesheet" href="./css/screens/result.css">
  <link rel="stylesheet" href="./css/screens/stats.css">
</head>
<body>

<div class="screen-container">

  <!-- â•â•â• HOME â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen active" id="homeScreen">
    <div class="home-header">
      <div>
        <h1>MathFlow</h1>
        <p id="homeSubtitle">pick a topic to practise</p>
      </div>
      <div style="display:flex;align-items:center;gap:8px">
        <div id="streakDisplay"
             onclick="showScreen('statsScreen')"
             style="display:none;font-family:'DM Mono',monospace;font-size:13px;color:var(--accent);cursor:pointer;background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:6px 10px"></div>
        <div onclick="toggleTheme()" id="themeBtn" class="icon-btn" style="font-size:16px">â˜€ï¸</div>
        <div onclick="showScreen('statsScreen')" class="icon-btn">ğŸ“Š</div>
      </div>
    </div>

    <div class="section-label">Addition</div>
    <div class="card-list" id="additionCards"></div>

    <div class="section-label">Subtraction</div>
    <div class="card-list" id="subtractionCards"></div>

    <div class="section-label">Multiplication</div>
    <div class="card-list" id="multiplicationCards"></div>

    <div class="section-label">Memory &amp; Recall</div>
    <div class="card-list" id="memoryCards"></div>
  </div>

  <!-- â•â•â• SUBTOPIC â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="subtopicScreen">
    <div class="nav-header">
      <div class="back-btn" onclick="showScreen('homeScreen')">â€¹</div>
      <div class="nav-header-info">
        <h2 id="subtopicTitle">â€”</h2>
        <p  id="subtopicSub">â€”</p>
      </div>
    </div>
    <div style="height:12px"></div>
    <div id="subtopicList"></div>
  </div>

  <!-- â•â•â• MODE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="modeScreen">
    <div class="nav-header">
      <div class="back-btn" id="modeBackBtn">â€¹</div>
      <div class="nav-header-info">
        <h2 id="modeTitle">â€”</h2>
        <p  id="modeSub">â€”</p>
      </div>
    </div>
    <div class="mode-body">
      <div class="mode-card" id="learnCard" onclick="selectMode('learn')">
        <div class="mode-card-title">ğŸ“– Learn</div>
        <div class="mode-card-desc">20 questions Â· feedback shown<br>use when building knowledge</div>
      </div>
      <div class="mode-card" id="practiceCard" onclick="selectMode('practice')">
        <div class="mode-card-title">âš¡ Practice</div>
        <div class="mode-card-desc">timed Â· minimal feedback Â· builds rhythm<br>use once you know the material</div>
        <div class="timer-options" id="timerOptions">
          <div class="timer-btn" onclick="selectTimer(event,2)">2 min</div>
          <div class="timer-btn" onclick="selectTimer(event,5)">5 min</div>
          <div class="timer-btn" onclick="selectTimer(event,10)">10 min</div>
        </div>
      </div>
      <div class="srs-info" id="srsInfo" style="display:none">
        âœ¦ smart recall active â€” questions weighted by your weak spots
      </div>
      <div style="flex:1"></div>
      <button class="start-btn" id="startBtn" onclick="startSession()">Start â†’</button>
    </div>
  </div>

  <!-- â•â•â• PRACTICE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="practiceScreen">
    <div class="practice-header">
      <div style="display:flex;align-items:center;gap:10px">
        <div class="back-btn" id="practiceBackBtn"
             onclick="confirmExitPractice()"
             style="width:28px;height:28px;font-size:17px">â€¹</div>
        <div class="practice-topic" id="practiceTopicLabel">â€”</div>
      </div>
      <div class="practice-meta" id="practiceMeta">â€”</div>
    </div>
    <div class="progress-bar" id="progressBar" style="width:0%"></div>

    <!-- Question + answer zone -->
    <div class="practice-top">
      <div class="question-type-label" id="questionTypeLabel">&nbsp;</div>
      <div class="question" id="question">â€”</div>
      <div class="answer-row">
        <!-- Mobile: styled div -->
        <div class="answer-display" id="answerDisplay">_</div>
        <!-- Desktop: real input -->
        <input class="answer-input" id="answerInput" type="number" inputmode="numeric"
               placeholder="?" autocomplete="off" autocorrect="off" spellcheck="false">
        <div class="feedback" id="feedback">&nbsp;</div>
      </div>
      <div class="desktop-hint" id="desktopHint">type Â· auto-submits Â· space to continue</div>
      <div class="score-row">
        <div>correct <span class="val" id="correctCount">0</span></div>
        <div>streak  <span class="val" id="streakVal">0</span></div>
      </div>
    </div>

    <!-- Mobile numpad -->
    <div class="practice-bottom">
      <div class="numpad" id="numpad">
        <div class="key" data-val="1">1</div>
        <div class="key" data-val="2">2</div>
        <div class="key" data-val="3">3</div>
        <div class="key" data-val="4">4</div>
        <div class="key" data-val="5">5</div>
        <div class="key" data-val="6">6</div>
        <div class="key" data-val="7">7</div>
        <div class="key" data-val="8">8</div>
        <div class="key" data-val="9">9</div>
        <div class="key key-del"    data-val="del">âŒ«</div>
        <div class="key"            data-val="0">0</div>
        <div class="key key-submit" data-val="submit">OK</div>
      </div>
    </div>
  </div>

  <!-- â•â•â• STATS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="statsScreen">
    <div class="nav-header">
      <div class="back-btn" onclick="showScreen('homeScreen')">â€¹</div>
      <div class="nav-header-info">
        <h2>Your Progress</h2>
        <p>activity &amp; streaks</p>
      </div>
    </div>
    <div style="padding:20px 18px;display:flex;flex-direction:column;gap:16px">

      <!-- Streak card -->
      <div style="background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:20px">
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:0.2em;color:var(--muted);text-transform:uppercase;margin-bottom:12px">Daily Streak</div>
        <div style="display:flex;align-items:baseline;gap:10px">
          <div id="statsStreakNum" style="font-family:'DM Mono',monospace;font-size:56px;color:var(--accent);font-weight:300;line-height:1">0</div>
          <div style="font-family:'DM Mono',monospace;font-size:13px;color:var(--muted2)">days</div>
        </div>
        <div id="statsStreakMsg" style="font-family:'DM Mono',monospace;font-size:11px;color:var(--muted);margin-top:6px">practise today to start your streak</div>
      </div>

      <!-- Weekly chart -->
      <div style="background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:20px">
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:0.2em;color:var(--muted);text-transform:uppercase;margin-bottom:16px">Last 7 Days</div>
        <div id="weeklyChart"  style="display:flex;align-items:flex-end;gap:6px;height:80px"></div>
        <div id="weeklyLabels" style="display:flex;gap:6px;margin-top:6px"></div>
      </div>

      <!-- All-time stats -->
      <div style="background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:20px">
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:0.2em;color:var(--muted);text-transform:uppercase;margin-bottom:12px">All Time</div>
        <div id="allTimeStats" style="display:flex;flex-direction:column;gap:10px"></div>
      </div>

      <!-- Settings -->
      <div style="background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:20px">
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:0.2em;color:var(--muted);text-transform:uppercase;margin-bottom:14px">Settings</div>

        <!-- Haptics -->
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
          <div>
            <div style="font-size:14px;font-weight:600">Haptic Feedback</div>
            <div style="font-family:'DM Mono',monospace;font-size:11px;color:var(--muted2);margin-top:2px">vibration on keypresses</div>
          </div>
          <div id="hapticsToggle" onclick="toggleHaptics()"
               style="width:44px;height:26px;border-radius:13px;cursor:pointer;transition:background 0.2s;position:relative;flex-shrink:0">
            <div id="hapticsThumb"
                 style="position:absolute;top:3px;width:20px;height:20px;border-radius:50%;transition:left 0.2s"></div>
          </div>
        </div>

        <div style="height:1px;background:var(--border);margin-bottom:16px"></div>

        <!-- Theme -->
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-size:14px;font-weight:600">Light Theme</div>
            <div style="font-family:'DM Mono',monospace;font-size:11px;color:var(--muted2);margin-top:2px">switch between dark and light</div>
          </div>
          <div id="themeToggle" onclick="toggleTheme()"
               style="width:44px;height:26px;border-radius:13px;cursor:pointer;transition:background 0.2s;position:relative;flex-shrink:0">
            <div id="themeThumb"
                 style="position:absolute;top:3px;width:20px;height:20px;border-radius:50%;transition:left 0.2s"></div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- â•â•â• RESULT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="resultScreen">
    <div class="result-inner">
      <div class="result-label">Session complete</div>
      <div class="result-big"     id="resultBig">â€”</div>
      <div class="result-topic"   id="resultTopic">â€”</div>
      <div class="result-stats"   id="resultStats"></div>
      <div class="result-message" id="resultMessage">â€”</div>
      <div class="result-btns">
        <button class="btn-secondary" onclick="showScreen('homeScreen')">Home</button>
        <button class="btn-primary"   onclick="startSession()">Again â†’</button>
      </div>
    </div>
  </div>

</div><!-- /.screen-container -->

<!-- â”€â”€ JS â€” loaded in dependency order â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<script defer src="./js/data/pools.js"></script>
<script defer src="./js/data/generators.js"></script>
<script defer src="./js/data/topics.js"></script>
<script defer src="./js/engine/srs.js"></script>
<script defer src="./js/engine/storage.js"></script>
<script defer src="./js/ui/navigation.js"></script>
<script defer src="./js/ui/settings.js"></script>
<script defer src="./js/ui/home.js"></script>
<script defer src="./js/ui/subtopic.js"></script>
<script defer src="./js/ui/mode.js"></script>
<script defer src="./js/ui/practice.js"></script>
<script defer src="./js/ui/result.js"></script>
<script defer src="./js/ui/stats.js"></script>
<script defer src="./js/app.js"></script>

</body>
</html>
